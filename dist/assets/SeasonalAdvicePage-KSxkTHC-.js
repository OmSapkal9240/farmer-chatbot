import{c as de,j as u,g as fe,d as he,a as ge,r as P}from"./index-SuqBYE3h.js";import{S as R}from"./seasonal-DMexktps.js";import{S as pe,D as Y}from"./save-Cos4ygta.js";import{M as me,I as be}from"./map-pin-WrJvmC1D.js";import{W as Ne}from"./WeatherCard-DsDt1gCR.js";import{B as ye}from"./bell-DMm_p-ge.js";const xe=de("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),ve=(o,m,d)=>{const p=R.tasks[o];if(!p||!p[m])return[{type:"task",task:"No specific advice for this month."}];let N=[...p[m]];return d&&d.length===6&&(parseInt(d.slice(-1),10)%2===0?N.push({type:"irrigate",task:"Prepare for moderate rainfall; ensure good drainage."}):N.push({type:"irrigate",task:"Conserve water; check soil moisture frequently."})),N},we=(o,m="json")=>{if(m==="json"){const d=JSON.stringify(o,null,2);return new Blob([d],{type:"application/json"})}else{let d=`Seasonal Schedule
`;return d+=`--------------------
`,d+=`Crop: ${o.crop.name}
`,d+=`Region/PIN: ${o.pin}
`,d+=`Month: ${o.month}

`,d+=`Tasks:
`,o.tasks.forEach(p=>{d+=`- [${p.type.toUpperCase()}] ${p.task}
`}),new Blob([d],{type:"text/plain"})}},ue=["January","February","March","April","May","June","July","August","September","October","November","December"],Ce=()=>u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-200",children:"Filters"}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"season-filter",className:"block text-sm font-medium text-gray-400",children:"Season"}),u.jsxs("select",{id:"season-filter",className:"w-full p-2 mt-1 bg-gray-700 border border-gray-600 rounded-md text-white",disabled:!0,children:[u.jsx("option",{children:"All"}),u.jsx("option",{children:"Kharif"}),u.jsx("option",{children:"Rabi"}),u.jsx("option",{children:"Zaid"})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"practice-filter",className:"block text-sm font-medium text-gray-400",children:"Farming Practice"}),u.jsxs("select",{id:"practice-filter",className:"w-full p-2 mt-1 bg-gray-700 border border-gray-600 rounded-md text-white",disabled:!0,children:[u.jsx("option",{children:"Any"}),u.jsx("option",{children:"Organic"}),u.jsx("option",{children:"Conventional"})]})]})]})]}),Ae=({schedule:o,onSave:m})=>{const d=p=>{const N=we(o,p),y=URL.createObjectURL(N),i=document.createElement("a");i.href=y,i.download=`seasonal-schedule-${o.crop.id}-${o.month}.${p}`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(y)};return u.jsxs("div",{className:"pt-6 border-t border-gray-700 space-y-4",children:[u.jsxs("button",{onClick:m,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition-colors",children:[u.jsx(pe,{size:20}),"Save Schedule"]}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("button",{onClick:()=>d("json"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-gray-600 text-white font-bold rounded-lg hover:bg-gray-500 transition-colors",children:[u.jsx(Y,{size:20}),"Download JSON"]}),u.jsxs("button",{onClick:()=>d("txt"),className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-gray-600 text-white font-bold rounded-lg hover:bg-gray-500 transition-colors",children:[u.jsx(Y,{size:20}),"Download Text"]})]})]})},Te=({crops:o,selectedCrop:m,onSelectCrop:d,pin:p,onPinChange:N,currentMonth:y,tasks:i})=>{const a=()=>{const c=JSON.parse(localStorage.getItem("seasonal_schedules"))||[],f={id:`sched_${m.id}_${Date.now()}`,crop:m,pin:p,month:y,tasks:i,savedAt:new Date().toISOString()};c.push(f),localStorage.setItem("seasonal_schedules",JSON.stringify(c)),alert("Schedule saved locally!")};return u.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"crop-select",className:"block text-sm font-bold text-gray-300 mb-2",children:"Select Crop"}),u.jsx("select",{id:"crop-select",value:m.id,onChange:c=>d(o.find(f=>f.id===c.target.value)),className:"w-full p-3 bg-gray-700 border border-gray-600 rounded-md text-white focus:ring-2 focus:ring-green-500",children:o.map(c=>u.jsx("option",{value:c.id,children:c.name},c.id))})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"pin-input",className:"block text-sm font-bold text-gray-300 mb-2",children:"Region / PIN Code"}),u.jsxs("div",{className:"relative",children:[u.jsx(me,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:20}),u.jsx("input",{id:"pin-input",type:"text",value:p,onChange:c=>N(c.target.value),placeholder:"Enter 6-digit PIN",maxLength:6,className:"w-full p-3 pl-10 bg-gray-700 border border-gray-600 rounded-md text-white focus:ring-2 focus:ring-green-500"})]})]}),u.jsx(Ce,{}),u.jsxs("div",{className:"pt-6 border-t border-gray-700",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-200 mb-3",children:"Quick Recommendations"}),u.jsxs("div",{className:"p-4 bg-gray-700/50 rounded-md text-sm text-gray-300 space-y-2",children:[u.jsx("p",{children:u.jsxs("strong",{children:["For ",m.name," in ",y,":"]})}),u.jsxs("ul",{className:"list-disc list-inside",children:[u.jsx("li",{children:"Check for early signs of pests."}),u.jsxs("li",{children:["Ensure irrigation matches mock rainfall forecast for PIN ",p,"."]}),u.jsx("li",{children:"Prepare for upcoming fertilizer application."})]})]})]}),u.jsx(Ae,{schedule:{crop:m,pin:p,month:y,tasks:i},onSave:a})]})},je={sowing:"bg-green-500",irrigate:"bg-blue-500",fertilizer:"bg-orange-500","pest-alert":"bg-red-500",harvest:"bg-yellow-500",task:"bg-gray-500"},_e=({selectedMonth:o,onSelectMonth:m,tasksByMonth:d})=>u.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Crop Calendar"}),u.jsx("div",{className:"flex flex-wrap gap-3",children:ue.map(p=>{const N=d[p]||[],y=N.length>0;return u.jsxs("button",{onClick:()=>m(p),className:`relative px-4 py-2 text-sm font-bold rounded-lg transition-all duration-200 w-28 h-20 flex flex-col justify-between items-start ${o===p?"bg-green-600 text-white scale-105 shadow-lg":"bg-gray-700 text-gray-300 hover:bg-gray-600"}`,children:[u.jsx("span",{children:p}),y&&u.jsx("div",{className:"flex space-x-1 self-end",children:N.slice(0,3).map((i,a)=>u.jsx("div",{className:`w-2 h-2 rounded-full ${je[i.type]||"bg-gray-400"}`,title:i.type},a))})]},p)})})]});var E={},B={},J={},$={},K;function I(){return K||(K=1,(function(o){const m=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",d=m+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",p="["+m+"]["+d+"]*",N=new RegExp("^"+p+"$"),y=function(a,c){const f=[];let x=c.exec(a);for(;x;){const h=[];h.startIndex=c.lastIndex-x[0].length;const g=x.length;for(let v=0;v<g;v++)h.push(x[v]);f.push(h),x=c.exec(a)}return f},i=function(a){const c=N.exec(a);return!(c===null||typeof c>"u")};o.isExist=function(a){return typeof a<"u"},o.isEmptyObject=function(a){return Object.keys(a).length===0},o.merge=function(a,c,f){if(c){const x=Object.keys(c),h=x.length;for(let g=0;g<h;g++)f==="strict"?a[x[g]]=[c[x[g]]]:a[x[g]]=c[x[g]]}},o.getValue=function(a){return o.isExist(a)?a:""},o.buildOptions=function(a,c,f){let x={};if(!a)return c;for(let h=0;h<f.length;h++)a[f[h]]!==void 0?x[f[h]]=a[f[h]]:x[f[h]]=c[f[h]];return x},o.isTagNameInArrayMode=function(a,c,f){return c===!1?!1:c instanceof RegExp?c.test(a):typeof c=="function"?!!c(a,f):c==="strict"},o.isName=i,o.getAllMatches=y,o.nameRegexp=p})($)),$}var H;function Pe(){if(H)return J;H=1;const o=I(),m=function(d,p,N){const y={};if(!p.alwaysCreateTextNode&&(!d.child||o.isEmptyObject(d.child))&&(!d.attrsMap||o.isEmptyObject(d.attrsMap)))return o.isExist(d.val)?d.val:"";if(o.isExist(d.val)&&!(typeof d.val=="string"&&(d.val===""||d.val===p.cdataPositionChar))){const a=o.isTagNameInArrayMode(d.tagname,p.arrayMode,N);y[p.textNodeName]=a?[d.val]:d.val}o.merge(y,d.attrsMap,p.arrayMode);const i=Object.keys(d.child);for(let a=0;a<i.length;a++){const c=i[a];if(d.child[c]&&d.child[c].length>1){y[c]=[];for(let f in d.child[c])d.child[c].hasOwnProperty(f)&&y[c].push(m(d.child[c][f],p,c))}else{const f=m(d.child[c][0],p,c),x=p.arrayMode===!0&&typeof f=="object"||o.isTagNameInArrayMode(c,p.arrayMode,N);y[c]=x?[f]:f}}return y};return J.convertToJson=m,J}var F={},z,G;function Ie(){return G||(G=1,z=function(o,m,d){this.tagname=o,this.parent=m,this.child={},this.attrsMap={},this.val=d,this.addChild=function(p){Array.isArray(this.child[p.tagname])?this.child[p.tagname].push(p):this.child[p.tagname]=[p]}}),z}var Z,D;function Ee(){if(D)return Z;D=1;const o=/^[-+]?0x[a-fA-F0-9]+$/,m=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,d={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function p(i,a={}){if(a=Object.assign({},d,a),!i||typeof i!="string")return i;let c=i.trim();if(a.skipLike!==void 0&&a.skipLike.test(c))return i;if(i==="0")return 0;if(a.hex&&o.test(c))return y(c,16);if(c.search(/[eE]/)!==-1){const f=c.match(/^([-\+])?(0*)([0-9]*(\.[0-9]*)?[eE][-\+]?[0-9]+)$/);if(f){if(a.leadingZeros)c=(f[1]||"")+f[3];else if(!(f[2]==="0"&&f[3][0]==="."))return i;return a.eNotation?Number(c):i}else return i}else{const f=m.exec(c);if(f){const x=f[1],h=f[2];let g=N(f[3]);if(!a.leadingZeros&&h.length>0&&x&&c[2]!==".")return i;if(!a.leadingZeros&&h.length>0&&!x&&c[1]!==".")return i;if(a.leadingZeros&&h===i)return 0;{const v=Number(c),r=""+v;return r.search(/[eE]/)!==-1?a.eNotation?v:i:c.indexOf(".")!==-1?r==="0"&&g===""||r===g||x&&r==="-"+g?v:i:h?g===r||x+g===r?v:i:c===r||c===x+r?v:i}}else return i}}function N(i){return i&&i.indexOf(".")!==-1&&(i=i.replace(/0+$/,""),i==="."?i="0":i[0]==="."?i="0"+i:i[i.length-1]==="."&&(i=i.substr(0,i.length-1))),i}function y(i,a){if(parseInt)return parseInt(i,a);if(Number.parseInt)return Number.parseInt(i,a);if(window&&window.parseInt)return window.parseInt(i,a);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}return Z=p,Z}var ee;function L(){if(ee)return F;ee=1;const o=I(),m=I().buildOptions,d=Ie(),p=Ee();"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,o.nameRegexp),!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const N={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,ignoreNameSpace:!1,allowBooleanAttributes:!1,parseNodeValue:!0,parseAttributeValue:!1,arrayMode:!1,trimValues:!0,cdataTagName:!1,cdataPositionChar:"\\c",numParseOptions:{hex:!0,leadingZeros:!0},tagValueProcessor:function(r,s){return r},attrValueProcessor:function(r,s){return r},stopNodes:[],alwaysCreateTextNode:!1};F.defaultOptions=N;const y=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","ignoreNameSpace","allowBooleanAttributes","parseNodeValue","parseAttributeValue","arrayMode","trimValues","cdataTagName","cdataPositionChar","tagValueProcessor","attrValueProcessor","parseTrueNumberOnly","numParseOptions","stopNodes","alwaysCreateTextNode"];F.props=y;function i(r,s,b){return s&&(b.trimValues&&(s=s.trim()),s=b.tagValueProcessor(s,r),s=c(s,b.parseNodeValue,b.numParseOptions)),s}function a(r,s){if(s.ignoreNameSpace){const b=r.split(":"),e=r.charAt(0)==="/"?"/":"";if(b[0]==="xmlns")return"";b.length===2&&(r=e+b[1])}return r}function c(r,s,b){if(s&&typeof r=="string"){const e=r.trim();return e==="true"?!0:e==="false"?!1:p(r,b)}else return o.isExist(r)?r:""}const f=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])(.*?)\\3)?`,"g");function x(r,s){if(!s.ignoreAttributes&&typeof r=="string"){r=r.replace(/\r?\n/g," ");const b=o.getAllMatches(r,f),e=b.length,t={};for(let n=0;n<e;n++){const A=a(b[n][1],s);A.length&&(b[n][4]!==void 0?(s.trimValues&&(b[n][4]=b[n][4].trim()),b[n][4]=s.attrValueProcessor(b[n][4],A),t[s.attributeNamePrefix+A]=c(b[n][4],s.parseAttributeValue,s.numParseOptions)):s.allowBooleanAttributes&&(t[s.attributeNamePrefix+A]=!0))}if(!Object.keys(t).length)return;if(s.attrNodeName){const n={};return n[s.attrNodeName]=t,n}return t}}const h=function(r,s){r=r.replace(/\r\n?/g,`
`),s=m(s,N,y);const b=new d("!xml");let e=b,t="";for(let n=0;n<r.length;n++)if(r[n]==="<")if(r[n+1]==="/"){const w=v(r,">",n,"Closing Tag is not closed.");let l=r.substring(n+2,w).trim();if(s.ignoreNameSpace){const _=l.indexOf(":");_!==-1&&(l=l.substr(_+1))}e&&(e.val?e.val=o.getValue(e.val)+""+i(l,t,s):e.val=i(l,t,s)),s.stopNodes.length&&s.stopNodes.includes(e.tagname)&&(e.child=[],e.attrsMap==null&&(e.attrsMap={}),e.val=r.substr(e.startIndex+1,n-e.startIndex-1)),e=e.parent,t="",n=w}else if(r[n+1]==="?")n=v(r,"?>",n,"Pi Tag is not closed.");else if(r.substr(n+1,3)==="!--")n=v(r,"-->",n,"Comment is not closed.");else if(r.substr(n+1,2)==="!D"){const w=v(r,">",n,"DOCTYPE is not closed.");r.substring(n,w).indexOf("[")>=0?n=r.indexOf("]>",n)+1:n=w}else if(r.substr(n+1,2)==="!["){const w=v(r,"]]>",n,"CDATA is not closed.")-2,l=r.substring(n+9,w);if(t&&(e.val=o.getValue(e.val)+""+i(e.tagname,t,s),t=""),s.cdataTagName){const _=new d(s.cdataTagName,e,l);e.addChild(_),e.val=o.getValue(e.val)+s.cdataPositionChar,l&&(_.val=l)}else e.val=(e.val||"")+(l||"");n=w+2}else{const w=g(r,n+1);let l=w.data;const _=w.index,M=l.indexOf(" ");let C=l,k=!0;if(M!==-1&&(C=l.substr(0,M).replace(/\s\s*$/,""),l=l.substr(M+1)),s.ignoreNameSpace){const T=C.indexOf(":");T!==-1&&(C=C.substr(T+1),k=C!==w.data.substr(T+1))}if(e&&t&&e.tagname!=="!xml"&&(e.val=o.getValue(e.val)+""+i(e.tagname,t,s)),l.length>0&&l.lastIndexOf("/")===l.length-1){C[C.length-1]==="/"?(C=C.substr(0,C.length-1),l=C):l=l.substr(0,l.length-1);const T=new d(C,e,"");C!==l&&(T.attrsMap=x(l,s)),e.addChild(T)}else{const T=new d(C,e);s.stopNodes.length&&s.stopNodes.includes(T.tagname)&&(T.startIndex=_),C!==l&&k&&(T.attrsMap=x(l,s)),e.addChild(T),e=T}t="",n=_}else t+=r[n];return b};function g(r,s){let b,e="";for(let t=s;t<r.length;t++){let n=r[t];if(b)n===b&&(b="");else if(n==='"'||n==="'")b=n;else{if(n===">")return{data:e,index:t};n==="	"&&(n=" ")}e+=n}}function v(r,s,b,e){const t=r.indexOf(s,b);if(t===-1)throw new Error(e);return t+s.length-1}return F.getTraversalObj=h,F}var U={},te;function ke(){if(te)return U;te=1;const o=I(),m={allowBooleanAttributes:!1},d=["allowBooleanAttributes"];U.validate=function(e,t){t=o.buildOptions(t,m,d);const n=[];let A=!1,w=!1;e[0]==="\uFEFF"&&(e=e.substr(1));for(let l=0;l<e.length;l++)if(e[l]==="<"&&e[l+1]==="?"){if(l+=2,l=p(e,l),l.err)return l}else if(e[l]==="<"){let _=l;if(l++,e[l]==="!"){l=N(e,l);continue}else{let M=!1;e[l]==="/"&&(M=!0,l++);let C="";for(;l<e.length&&e[l]!==">"&&e[l]!==" "&&e[l]!=="	"&&e[l]!==`
`&&e[l]!=="\r";l++)C+=e[l];if(C=C.trim(),C[C.length-1]==="/"&&(C=C.substring(0,C.length-1),l--),!r(C)){let j;return C.trim().length===0?j="Invalid space after '<'.":j="Tag '"+C+"' is an invalid name.",g("InvalidTag",j,s(e,l))}const k=a(e,l);if(k===!1)return g("InvalidAttr","Attributes for '"+C+"' have open quote.",s(e,l));let T=k.value;if(l=k.index,T[T.length-1]==="/"){const j=l-T.length;T=T.substring(0,T.length-1);const S=f(T,t);if(S===!0)A=!0;else return g(S.err.code,S.err.msg,s(e,j+S.err.line))}else if(M)if(k.tagClosed){if(T.trim().length>0)return g("InvalidTag","Closing tag '"+C+"' can't have attributes or invalid starting.",s(e,_));{const j=n.pop();if(C!==j.tagName){let S=s(e,j.tagStartPos);return g("InvalidTag","Expected closing tag '"+j.tagName+"' (opened in line "+S.line+", col "+S.col+") instead of closing tag '"+C+"'.",s(e,_))}n.length==0&&(w=!0)}}else return g("InvalidTag","Closing tag '"+C+"' doesn't have proper closing.",s(e,l));else{const j=f(T,t);if(j!==!0)return g(j.err.code,j.err.msg,s(e,l-T.length+j.err.line));if(w===!0)return g("InvalidXml","Multiple possible root nodes found.",s(e,l));n.push({tagName:C,tagStartPos:_}),A=!0}for(l++;l<e.length;l++)if(e[l]==="<")if(e[l+1]==="!"){l++,l=N(e,l);continue}else if(e[l+1]==="?"){if(l=p(e,++l),l.err)return l}else break;else if(e[l]==="&"){const j=h(e,l);if(j==-1)return g("InvalidChar","char '&' is not expected.",s(e,l));l=j}e[l]==="<"&&l--}}else{if(e[l]===" "||e[l]==="	"||e[l]===`
`||e[l]==="\r")continue;return g("InvalidChar","char '"+e[l]+"' is not expected.",s(e,l))}if(A){if(n.length==1)return g("InvalidTag","Unclosed tag '"+n[0].tagName+"'.",s(e,n[0].tagStartPos));if(n.length>0)return g("InvalidXml","Invalid '"+JSON.stringify(n.map(l=>l.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return g("InvalidXml","Start tag expected.",1);return!0};function p(e,t){const n=t;for(;t<e.length;t++)if(e[t]=="?"||e[t]==" "){const A=e.substr(n,t-n);if(t>5&&A==="xml")return g("InvalidXml","XML declaration allowed only at the start of the document.",s(e,t));if(e[t]=="?"&&e[t+1]==">"){t++;break}else continue}return t}function N(e,t){if(e.length>t+5&&e[t+1]==="-"&&e[t+2]==="-"){for(t+=3;t<e.length;t++)if(e[t]==="-"&&e[t+1]==="-"&&e[t+2]===">"){t+=2;break}}else if(e.length>t+8&&e[t+1]==="D"&&e[t+2]==="O"&&e[t+3]==="C"&&e[t+4]==="T"&&e[t+5]==="Y"&&e[t+6]==="P"&&e[t+7]==="E"){let n=1;for(t+=8;t<e.length;t++)if(e[t]==="<")n++;else if(e[t]===">"&&(n--,n===0))break}else if(e.length>t+9&&e[t+1]==="["&&e[t+2]==="C"&&e[t+3]==="D"&&e[t+4]==="A"&&e[t+5]==="T"&&e[t+6]==="A"&&e[t+7]==="["){for(t+=8;t<e.length;t++)if(e[t]==="]"&&e[t+1]==="]"&&e[t+2]===">"){t+=2;break}}return t}const y='"',i="'";function a(e,t){let n="",A="",w=!1;for(;t<e.length;t++){if(e[t]===y||e[t]===i)A===""?A=e[t]:A!==e[t]||(A="");else if(e[t]===">"&&A===""){w=!0;break}n+=e[t]}return A!==""?!1:{value:n,index:t,tagClosed:w}}const c=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function f(e,t){const n=o.getAllMatches(e,c),A={};for(let w=0;w<n.length;w++){if(n[w][1].length===0)return g("InvalidAttr","Attribute '"+n[w][2]+"' has no space in starting.",b(n[w]));if(n[w][3]===void 0&&!t.allowBooleanAttributes)return g("InvalidAttr","boolean attribute '"+n[w][2]+"' is not allowed.",b(n[w]));const l=n[w][2];if(!v(l))return g("InvalidAttr","Attribute '"+l+"' is an invalid name.",b(n[w]));if(!A.hasOwnProperty(l))A[l]=1;else return g("InvalidAttr","Attribute '"+l+"' is repeated.",b(n[w]))}return!0}function x(e,t){let n=/\d/;for(e[t]==="x"&&(t++,n=/[\da-fA-F]/);t<e.length;t++){if(e[t]===";")return t;if(!e[t].match(n))break}return-1}function h(e,t){if(t++,e[t]===";")return-1;if(e[t]==="#")return t++,x(e,t);let n=0;for(;t<e.length;t++,n++)if(!(e[t].match(/\w/)&&n<20)){if(e[t]===";")break;return-1}return t}function g(e,t,n){return{err:{code:e,msg:t,line:n.line||n,col:n.col}}}function v(e){return o.isName(e)}function r(e){return o.isName(e)}function s(e,t){const n=e.substring(0,t).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function b(e){return e.startIndex+e[1].length}return U}var W={},re;function Se(){if(re)return W;re=1;const o=function(h){return String.fromCharCode(h)},m={nilChar:o(176),missingChar:o(201),nilPremitive:o(175),missingPremitive:o(200),emptyChar:o(178),emptyValue:o(177),boundryChar:o(179),objStart:o(198),arrStart:o(204),arrayEnd:o(185)},d=[m.nilChar,m.nilPremitive,m.missingChar,m.missingPremitive,m.boundryChar,m.emptyChar,m.emptyValue,m.arrayEnd,m.objStart,m.arrStart],p=function(h,g,v){if(typeof g=="string")return h&&h[0]&&h[0].val!==void 0?N(h[0].val):N(h);{const r=a(h);if(r===!0){let s="";if(Array.isArray(g)){s+=m.arrStart;const b=g[0],e=h.length;if(typeof b=="string")for(let t=0;t<e;t++){const n=N(h[t].val);s=y(s,n)}else for(let t=0;t<e;t++){const n=p(h[t],b,v);s=y(s,n)}s+=m.arrayEnd}else{s+=m.objStart;const b=Object.keys(g);Array.isArray(h)&&(h=h[0]);for(let e in b){const t=b[e];let n;!v.ignoreAttributes&&h.attrsMap&&h.attrsMap[t]?n=p(h.attrsMap[t],g[t],v):t===v.textNodeName?n=p(h.val,g[t],v):n=p(h.child[t],g[t],v),s=y(s,n)}}return s}else return r}},N=function(h){switch(h){case void 0:return m.missingPremitive;case null:return m.nilPremitive;case"":return m.emptyValue;default:return h}},y=function(h,g){return!i(g[0])&&!i(h[h.length-1])&&(h+=m.boundryChar),h+g},i=function(h){return d.indexOf(h)!==-1};function a(h){return h===void 0?m.missingChar:h===null?m.nilChar:h.child&&Object.keys(h.child).length===0&&(!h.attrsMap||Object.keys(h.attrsMap).length===0)?m.emptyChar:!0}const c=L(),f=I().buildOptions,x=function(h,g,v){return v=f(v,c.defaultOptions,c.props),p(h,g,v)};return W.convert2nimn=x,W}var X={},se;function Oe(){if(se)return X;se=1;const o=I(),m=I().buildOptions,d=L(),p=function(i,a){return a=m(a,d.defaultOptions,d.props),a.indentBy=a.indentBy||"",N(i,a)},N=function(i,a,c){let f="{";const x=Object.keys(i.child);for(let h=0;h<x.length;h++){const g=x[h];if(i.child[g]&&i.child[g].length>1){f+='"'+g+'" : [ ';for(let v in i.child[g])f+=N(i.child[g][v],a)+" , ";f=f.substr(0,f.length-1)+" ] "}else f+='"'+g+'" : '+N(i.child[g][0],a)+" ,"}return o.merge(f,i.attrsMap),o.isEmptyObject(f)?o.isExist(i.val)?i.val:"":(o.isExist(i.val)&&(typeof i.val=="string"&&(i.val===""||i.val===a.cdataPositionChar)||(f+='"'+a.textNodeName+'" : '+y(i.val))),f[f.length-1]===","&&(f=f.substr(0,f.length-2)),f+"}")};function y(i){return i===!0||i===!1||!isNaN(i)?i:'"'+i+'"'}return X.convertToJsonString=p,X}var Q,ne;function Me(){if(ne)return Q;ne=1;const o=I().buildOptions,m={attributeNamePrefix:"@_",attrNodeName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataTagName:!1,cdataPositionChar:"\\c",format:!1,indentBy:"  ",supressEmptyNode:!1,tagValueProcessor:function(r){return r},attrValueProcessor:function(r){return r}},d=["attributeNamePrefix","attrNodeName","textNodeName","ignoreAttributes","cdataTagName","cdataPositionChar","format","indentBy","supressEmptyNode","tagValueProcessor","attrValueProcessor","rootNodeName"];function p(r){this.options=o(r,m,d),this.options.ignoreAttributes||this.options.attrNodeName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=g),this.options.cdataTagName?this.isCDATA=v:this.isCDATA=function(){return!1},this.replaceCDATAstr=y,this.replaceCDATAarr=i,this.processTextOrObjNode=N,this.options.format?(this.indentate=h,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.supressEmptyNode?(this.buildTextNode=x,this.buildObjNode=c):(this.buildTextNode=f,this.buildObjNode=a),this.buildTextValNode=f,this.buildObjectNode=a}p.prototype.parse=function(r){return Array.isArray(r)&&this.options.rootNodeName&&this.options.rootNodeName.length>1&&(r={[this.options.rootNodeName]:r}),this.j2x(r,0).val},p.prototype.j2x=function(r,s){let b="",e="";for(let t in r)if(!(typeof r[t]>"u"))if(r[t]===null)e+=this.indentate(s)+"<"+t+"/"+this.tagEndChar;else if(r[t]instanceof Date)e+=this.buildTextNode(r[t],t,"",s);else if(typeof r[t]!="object"){const n=this.isAttribute(t);n?b+=" "+n+'="'+this.options.attrValueProcessor(""+r[t])+'"':this.isCDATA(t)?r[this.options.textNodeName]?e+=this.replaceCDATAstr(r[this.options.textNodeName],r[t]):e+=this.replaceCDATAstr("",r[t]):t===this.options.textNodeName?r[this.options.cdataTagName]||(e+=this.options.tagValueProcessor(""+r[t])):e+=this.buildTextNode(r[t],t,"",s)}else if(Array.isArray(r[t]))if(this.isCDATA(t))e+=this.indentate(s),r[this.options.textNodeName]?e+=this.replaceCDATAarr(r[this.options.textNodeName],r[t]):e+=this.replaceCDATAarr("",r[t]);else{const n=r[t].length;for(let A=0;A<n;A++){const w=r[t][A];typeof w>"u"||(w===null?e+=this.indentate(s)+"<"+t+"/"+this.tagEndChar:typeof w=="object"?e+=this.processTextOrObjNode(w,t,s):e+=this.buildTextNode(w,t,"",s))}}else if(this.options.attrNodeName&&t===this.options.attrNodeName){const n=Object.keys(r[t]),A=n.length;for(let w=0;w<A;w++)b+=" "+n[w]+'="'+this.options.attrValueProcessor(""+r[t][n[w]])+'"'}else e+=this.processTextOrObjNode(r[t],t,s);return{attrStr:b,val:e}};function N(r,s,b){const e=this.j2x(r,b+1);return r[this.options.textNodeName]!==void 0&&Object.keys(r).length===1?this.buildTextNode(e.val,s,e.attrStr,b):this.buildObjNode(e.val,s,e.attrStr,b)}function y(r,s){return r=this.options.tagValueProcessor(""+r),this.options.cdataPositionChar===""||r===""?r+"<![CDATA["+s+"]]"+this.tagEndChar:r.replace(this.options.cdataPositionChar,"<![CDATA["+s+"]]"+this.tagEndChar)}function i(r,s){if(r=this.options.tagValueProcessor(""+r),this.options.cdataPositionChar===""||r==="")return r+"<![CDATA["+s.join("]]><![CDATA[")+"]]"+this.tagEndChar;for(let b in s)r=r.replace(this.options.cdataPositionChar,"<![CDATA["+s[b]+"]]>");return r+this.newLine}function a(r,s,b,e){return b&&r.indexOf("<")===-1?this.indentate(e)+"<"+s+b+">"+r+"</"+s+this.tagEndChar:this.indentate(e)+"<"+s+b+this.tagEndChar+r+this.indentate(e)+"</"+s+this.tagEndChar}function c(r,s,b,e){return r!==""?this.buildObjectNode(r,s,b,e):this.indentate(e)+"<"+s+b+"/"+this.tagEndChar}function f(r,s,b,e){return this.indentate(e)+"<"+s+b+">"+this.options.tagValueProcessor(r)+"</"+s+this.tagEndChar}function x(r,s,b,e){return r!==""?this.buildTextValNode(r,s,b,e):this.indentate(e)+"<"+s+b+"/"+this.tagEndChar}function h(r){return this.options.indentBy.repeat(r)}function g(r){return r.startsWith(this.options.attributeNamePrefix)?r.substr(this.attrPrefixLen):!1}function v(r){return r===this.options.cdataTagName}return Q=p,Q}var ie;function Ve(){return ie||(ie=1,(function(o){const m=Pe(),d=L(),p=L(),N=I().buildOptions,y=ke();o.parse=function(i,a={},c){if(c){c===!0&&(c={});const h=y.validate(i,c);if(h!==!0)throw Error(h.err.msg)}a.parseTrueNumberOnly&&a.parseNodeValue!==!1&&!a.numParseOptions&&(a.numParseOptions={leadingZeros:!1});let f=N(a,p.defaultOptions,p.props);const x=d.getTraversalObj(i,f);return m.convertToJson(x,f)},o.convertTonimn=Se().convert2nimn,o.getTraversalObj=d.getTraversalObj,o.convertToJson=m.convertToJson,o.convertToJsonString=Oe().convertToJsonString,o.validate=y.validate,o.j2xParser=Me(),o.parseToNimn=function(i,a,c){return o.convertTonimn(o.getTraversalObj(i,c),a,c)}})(B)),B}var O={},ae;function Fe(){if(ae)return O;ae=1,Object.defineProperty(O,"__esModule",{value:!0}),O.isLanguageCode=O.isDegreeType=void 0;function o(d){return typeof d=="string"&&d==="C"||d==="F"}O.isDegreeType=o;function m(d){return typeof d=="string"&&d.length===2&&!!d.match(/[A-Za-z]/)}return O.isLanguageCode=m,O}var V={};const Re={},qe=Object.freeze(Object.defineProperty({__proto__:null,default:Re},Symbol.toStringTag,{value:"Module"})),Le=fe(qe);var oe;function Be(){if(oe)return V;oe=1;var o=V&&V.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(V,"__esModule",{value:!0});const m=o(Le);function d(p){return new Promise((N,y)=>{const i=m.default.get(p,a=>{let c="";a.statusCode!==200&&y(new Error(`Request failed with status ${a.statusCode}`)),a.on("data",f=>{c+=f}),a.on("end",()=>{N(c)})});i.setTimeout(5e3),i.on("timeout",()=>{y(new Error("Request timed out after 5s"))}),i.on("error",a=>{y(a)})})}return V.default=d,V}var q={},le;function Je(){if(le)return q;le=1,Object.defineProperty(q,"__esModule",{value:!0});const o={0:"thunderstorm",1:"thunderstorm",2:"thunderstorm",3:"thunderstorm",4:"thunderstorm",17:"thunderstorm",35:"thunderstorm",5:"rain_snow_mix",6:"sleet_snow_mix",7:"rain_snow_sleet_mix",8:"light_rain",9:"light_rain",10:"rain_sleet_mix",11:"rain_shower",12:"rain",13:"light_snow",14:"snow",16:"snow",42:"snow",43:"snow",15:"blizzard",18:"rain_showers",40:"rain_showers",19:"dust",20:"foggy",21:"haze",22:"smoke",23:"windy",24:"windy",25:"frigid",26:"cloudy",27:"mostly_cloudy_night",29:"mostly_cloudy_night",33:"mostly_cloudy_night",28:"partly_sunny",30:"partly_sunny",34:"partly_sunny",31:"clear_night",32:"clear",36:"hot",37:"scattered_thunderstorms",38:"scattered_thunderstorms",39:"scattered_rain_showers",41:"scattered_snow_showers",45:"scattered_rain_showers_night",46:"scattered_snow_showers_night",47:"scattered_thunderstorms_night"};return q.default=o,q}var ce;function $e(){if(ce)return E;ce=1;var o=E&&E.__awaiter||function(a,c,f,x){function h(g){return g instanceof f?g:new f(function(v){v(g)})}return new(f||(f=Promise))(function(g,v){function r(e){try{b(x.next(e))}catch(t){v(t)}}function s(e){try{b(x.throw(e))}catch(t){v(t)}}function b(e){e.done?g(e.value):h(e.value).then(r,s)}b((x=x.apply(a,c||[])).next())})},m=E&&E.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(E,"__esModule",{value:!0});const d=m(Ve()),p=Fe(),N=m(Be()),y=m(Je());function i(a){return o(this,void 0,void 0,function*(){if(!a||typeof a!="object")throw new Error("Invalid options were specified");if(!a.location)throw new Error("No location was given");const c=a.language||"en",f=a.degreeType||"C";if(!p.isLanguageCode(c))throw new Error(`
            Invalid language code '${c}', make sure it adheres to the ISO 639.1:2002 standard
        `);if(!p.isDegreeType(f))throw new Error(`Invalid degree type '${f}'`);const x=`https://weather.service.msn.com/find.aspx?src=msn&weadegreetype=${f}&culture=${c}&weasearchstr=${encodeURIComponent(a.location)}`,h=yield N.default(x),g=d.default.parse(h,{attributeNamePrefix:"",ignoreAttributes:!1,ignoreNameSpace:!0,trimValues:!0});if(!g||!g.weatherdata||!g.weatherdata.weather)throw new Error("Bad response: Failed to parse response body");const v=g.weatherdata.weather[0];if(!v)throw new Error("Bad response: Failed to receive weather data");const r=v.current,s=[];for(let e=1;e<v.forecast.length;e++){const t=v.forecast[e];s.push({date:t.date,day:t.day,temperature:{low:t.low[0]+`째${f}`,high:t.high[0]+`째${f}`},sky:{code:y.default[t.skycodeday[0]],text:t.skytextday[0]},precip:t.precip[0]+"%"})}return{current:{date:r.date,day:r.day,temperature:r.temperature+`째${f}`,sky:{code:y.default[r.skycode],text:r.skytext},observation:{time:r.observationtime,point:r.observationpoint},feelsLike:r.feelslike+`째${f}`,humidity:r.humidity+"%",wind:{display:r.winddisplay,speed:r.windspeed}},forecasts:s}})}return E.default={search:i},E}var ze=$e();const Ze=he(ze),Ue=({task:o,cropId:m,month:d})=>{const p=`${m}-${d}-${o.task}`,[N,y]=P.useState(()=>localStorage.getItem(p)==="true"),i=()=>{const a=!N;y(a),localStorage.setItem(p,a)};return u.jsxs("div",{className:`flex items-center justify-between p-3 rounded-md transition-colors ${N?"bg-green-900/50 text-gray-500":"bg-gray-700/50"}`,children:[u.jsx("span",{className:`${N?"line-through":""}`,children:o.task}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{className:"p-1 text-gray-400 hover:text-white",title:"Set Reminder (mock)",children:u.jsx(ye,{size:16})}),u.jsxs("button",{onClick:i,className:"flex items-center space-x-1 text-sm text-gray-300 hover:text-white",children:[u.jsx(xe,{size:16,className:`${N?"text-green-400":""}`}),u.jsx("span",{children:N?"Done":"Mark Done"})]})]})]})},We=({crop:o,month:m,tasks:d,isLoading:p})=>{const{t:N,i18n:y}=ge(),i=R.tips[o.id]||{},[a,c]=P.useState(null),[f,x]=P.useState(!0);return P.useEffect(()=>{(async()=>{x(!0);try{const g=await Ze({city:"Pune",lang:y.language,degreeType:"C"});c(g)}catch(g){console.error("Failed to fetch weather data:",g),c(null)}finally{x(!1)}})()},[y.language]),p?u.jsx("div",{className:"bg-gray-800 p-6 rounded-lg",children:u.jsxs("div",{className:"animate-pulse space-y-4",children:[u.jsx("div",{className:"h-8 bg-gray-700 rounded w-1/3"}),u.jsx("div",{className:"h-4 bg-gray-700 rounded w-full"}),u.jsx("div",{className:"h-4 bg-gray-700 rounded w-2/3"})]})}):u.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"font-semibold text-gray-300 mb-3 text-lg",children:"Weather Insights"}),u.jsx(Ne,{weatherData:a,isLoading:f})]}),u.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Tasks & Tips for ",m]}),u.jsxs("div",{className:"space-y-3 mb-6",children:[u.jsx("h3",{className:"font-semibold text-gray-300",children:"Tasks:"}),d.map((h,g)=>u.jsx(Ue,{task:h,cropId:o.id,month:m},g))]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"font-semibold text-gray-300",children:"Contextual Tips:"}),Object.entries(i).map(([h,g])=>u.jsxs("div",{className:"p-4 bg-gray-700/50 rounded-md",children:[u.jsx("h4",{className:"font-bold capitalize text-green-400",children:h}),u.jsx("p",{className:"text-gray-300 mt-1",children:N(g[y.language]||g.en)}),u.jsxs("div",{className:"group relative inline-block mt-2",children:[u.jsx(be,{size:16,className:"text-blue-400 cursor-pointer"}),u.jsxs("div",{className:"absolute bottom-full mb-2 w-64 bg-gray-900 text-white text-xs rounded py-2 px-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300 z-10",children:[g.why,u.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 top-full w-0 h-0 border-x-8 border-x-transparent border-t-8 border-t-gray-900"})]})]})]},h))]})]})},De=()=>{const[o,m]=P.useState(R.crops[0]),[d,p]=P.useState(ue[new Date().getMonth()]),[N,y]=P.useState("421302"),[i,a]=P.useState([]),[c,f]=P.useState(!1);return P.useEffect(()=>{f(!0);const x=setTimeout(()=>{const h=ve(o.id,d,N);a(h),f(!1)},500);return()=>clearTimeout(x)},[o,d,N]),u.jsxs("div",{className:"container mx-auto p-4 md:p-6 bg-gray-900 text-white rounded-lg",children:[u.jsxs("header",{className:"text-center mb-6",children:[u.jsx("h1",{className:"text-4xl font-bold text-green-400",children:"Seasonal Farming Advice"}),u.jsx("p",{className:"text-gray-400 mt-2",children:"Your monthly guide to optimal crop management."})]}),u.jsxs("div",{className:"flex flex-col lg:flex-row lg:space-x-8",children:[u.jsx("aside",{className:"w-full lg:w-1/3 lg:max-w-md mb-8 lg:mb-0",children:u.jsx(Te,{crops:R.crops,selectedCrop:o,onSelectCrop:m,pin:N,onPinChange:y,currentMonth:d,tasks:i})}),u.jsxs("main",{className:"w-full lg:w-2/3",children:[u.jsx(_e,{selectedMonth:d,onSelectMonth:p,tasksByMonth:R.tasks[o.id]}),u.jsx("div",{className:"mt-6",children:u.jsx(We,{crop:o,month:d,tasks:i,isLoading:c})})]})]})]})};export{De as default};
