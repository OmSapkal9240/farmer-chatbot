import{c as S,e as N,u as A,r as n,j as e,A as I,m as b}from"./index-SuqBYE3h.js";import{c as C,A as _}from"./crops-N1iP_pkT.js";import{S as E}from"./schemes-BP6yw30A.js";import{S as T}from"./seasonal-DMexktps.js";const M=S("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),i=s=>`https://via.placeholder.com/224x224.png/ff0000/ffffff?text=${s.replace(/ /g,"+")}`,P=[{id:"tomato_late_blight",label:{en:"Tomato Late Blight",hi:"टमाटर का पछेती झुलसा",mr:"टोमॅटोचा करपा रोग"},exampleImages:[i("Late Blight 1"),i("Late Blight 2")],description:"A destructive fungal disease that can quickly ruin tomato and potato crops.",symptoms:["Dark, water-soaked spots on leaves and stems.","White mold on the underside of leaves in humid conditions."],likelyCrops:["Tomato","Potato"],preventiveMeasures:["Ensure good air circulation.","Avoid overhead watering.","Use disease-resistant varieties."],treatments:{organic:["Apply copper-based fungicides.","Remove and destroy infected plants immediately."],chemical:["Fungicides containing mancozeb or chlorothalonil."]},exampleKeywords:["leaf","spot","brown","tomato","potato"]},{id:"cotton_bollworm",label:{en:"Cotton Bollworm",hi:"कपास का बॉलवर्म",mr:"कापसावरील बोंडअळी"},exampleImages:[i("Bollworm 1"),i("Bollworm 2")],description:"A major pest of cotton, causing significant damage to bolls and reducing yield.",symptoms:["Holes in cotton bolls.","Presence of larvae inside bolls.","Damaged squares and flowers."],likelyCrops:["Cotton","Corn","Tomato"],preventiveMeasures:["Use pheromone traps to monitor moth activity.","Encourage natural predators."],treatments:{organic:["Neem oil spray.","Use of Bt (Bacillus thuringiensis) formulations."],chemical:["Pyrethroids","Spinosad-based insecticides."]},exampleKeywords:["worm","hole","boll","cotton"]},{id:"rice_leaf_folder",label:{en:"Rice Leaf Folder",hi:"धान का पत्ती मोड़क",mr:"भात पिकावरील पाने गुंडाळणारी अळी"},exampleImages:[i("Leaf Folder 1")],description:"Larvae fold rice leaves and feed from within, causing white, transparent streaks.",symptoms:["Leaves folded longitudinally.","Scraping of green tissue, creating white streaks."],likelyCrops:["Rice (Paddy)"],preventiveMeasures:["Avoid excessive nitrogen fertilizer.","Maintain proper spacing."],treatments:{organic:["Release of Trichogramma wasps.","Spray with neem-based pesticides."],chemical:["Insecticides like cartap hydrochloride or fipronil."]},exampleKeywords:["leaf","fold","white","streak","rice"]},{id:"onion_thrips",label:{en:"Onion Thrips",hi:"प्याज का थ्रिप्स",mr:"कांद्यावरील फुलकिडे"},exampleImages:[i("Thrips 1")],description:"Tiny insects that feed on onion leaves, causing silvery-white patches and reducing bulb size.",symptoms:["Silvery-white patches or streaks on leaves.","Stunted plant growth.","Distorted leaves."],likelyCrops:["Onion","Garlic"],preventiveMeasures:["Use of blue sticky traps.","Overhead irrigation can wash off thrips."],treatments:{organic:["Spraying with insecticidal soap or neem oil."],chemical:["Spinosad or imidacloprid-based insecticides."]},exampleKeywords:["silver","white","spot","onion","leaf"]},{id:"groundnut_leaf_spot",label:{en:"Groundnut Leaf Spot (Tikka)",hi:"मूंगफली का पर्ण चित्ती रोग (टिक्का)",mr:"भुईमुगावरील टिक्का रोग"},exampleImages:[i("Tikka 1")],description:"A common fungal disease causing circular spots on leaves, leading to defoliation.",symptoms:["Dark brown to black circular spots on leaves, often with a yellow halo."],likelyCrops:["Groundnut"],preventiveMeasures:["Crop rotation.","Use of certified disease-free seeds."],treatments:{organic:["Spray with a mixture of baking soda and horticultural oil."],chemical:["Fungicides containing chlorothalonil or mancozeb."]},exampleKeywords:["spot","brown","yellow","halo","groundnut","leaf"]},{id:"aphids_general",label:{en:"Aphids (General)",hi:"एफिड्स (माहू)",mr:"मावा किड"},exampleImages:[i("Aphids 1")],description:"Small, sap-sucking insects that can cause curling, yellowing of leaves, and transmit viruses.",symptoms:["Clusters of small insects on new growth or underside of leaves.","Sticky “honeydew” on leaves.","Sooty mold growth."],likelyCrops:["Many, including vegetables and field crops"],preventiveMeasures:["Encourage ladybugs and other natural predators.","Regularly inspect plants."],treatments:{organic:["Strong jet of water to dislodge them.","Insecticidal soap or neem oil."],chemical:["Neonicotinoids (use with caution), pyrethrins."]},exampleKeywords:["small","green","black","insect","sticky","leaf"]}],D=()=>JSON.stringify({crops:C,pests:P,schemes:E,seasonal_advice:T}),B=()=>({role:"system",content:`You are an expert assistant for a farmer advisory application. Your knowledge is strictly limited to the data provided below. Do not answer any questions that are not related to this data. If a user asks about something not in the context, politely decline and state that you can only answer questions about the provided crop, pest, scheme, and seasonal information.

Here is the application's data:

${D()}`});function $(){const{chatId:s}=N(),v=A(),[r,l]=n.useState([]),[m,u]=n.useState(""),[c,h]=n.useState(!1),[f,g]=n.useState(null),p=n.useRef(null);n.useEffect(()=>{try{const a=JSON.parse(localStorage.getItem("chat_sessions")||"[]").find(o=>o.id===s);l(a?a.messages:[{role:"assistant",content:"Namaskar! How can I assist you?"}])}catch{l([{role:"assistant",content:"Namaskar! How can I assist you?"}])}},[s]),n.useEffect(()=>{if(r.length>1){const t=JSON.parse(localStorage.getItem("chat_sessions")||"[]"),a=t.findIndex(x=>x.id===s),o={id:s,title:r[1]?.content.substring(0,30)||"New Chat",messages:r};a!==-1?t[a]=o:t.push(o),localStorage.setItem("chat_sessions",JSON.stringify(t.slice(-10)))}},[r,s]),n.useEffect(()=>{p.current?.scrollTo({top:p.current.scrollHeight,behavior:"smooth"})},[r,c]);const y=n.useCallback(async()=>{if(m.trim()===""||c)return;const t={role:"user",content:m},a=[...r,t];l(a),u(""),h(!0),g(null);try{const o=await fetch("https://openrouter.ai/api/v1/chat/completions",{method:"POST",headers:{Authorization:"Bearer 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","Content-Type":"application/json"},body:JSON.stringify({model:"openai/gpt-4o-mini",messages:[B(),...a.map(({role:d,content:j})=>({role:d,content:j}))]})});if(!o.ok){const d=await o.json();throw new Error(d.error?.message||"An unknown error occurred.")}const k=(await o.json()).choices[0].message;l(d=>[...d,k])}catch(o){g({type:"API_ERROR",message:o.message||"Failed to get response from AI."})}finally{h(!1)}},[m,c,r,s]),w=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),y())};return e.jsx("div",{className:"min-h-screen flex flex-col items-center px-4 sm:px-6 py-8 bg-gradient-to-b from-[#0a0f1f] to-[#10172d]",children:e.jsxs("div",{className:"w-full max-w-3xl flex flex-col h-[85vh]",children:[e.jsxs("div",{className:"relative flex items-center justify-center mb-4 p-2",children:[e.jsx("button",{className:"absolute left-0 text-sm text-slate-300 hover:text-white transition",onClick:()=>v("/"),children:"← Home"}),e.jsx("h1",{className:"font-orbitron font-bold text-xl text-center",children:"Agri-Assistant"})]}),e.jsxs("div",{className:"flex-1 flex flex-col bg-slate-900/70 backdrop-blur-md rounded-2xl shadow-xl overflow-hidden border border-slate-800",children:[f&&e.jsx(K,{error:f}),e.jsxs("div",{ref:p,className:"flex-1 p-4 space-y-4 overflow-y-auto scroll-smooth",children:[e.jsx(I,{children:r.map((t,a)=>e.jsx(L,{msg:t},a))}),c&&e.jsx(O,{})]}),e.jsx("div",{className:"p-4 bg-slate-900/50 border-t border-slate-800",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("textarea",{rows:1,value:m,onChange:t=>u(t.target.value),onKeyDown:w,placeholder:"Ask about your crops...","aria-label":"Chat input",className:"flex-grow bg-slate-800 border border-slate-600 rounded-lg py-2 px-3 text-white placeholder-slate-400 focus:outline-none focus:ring-1 focus:ring-cyan-500 transition-all duration-300 resize-none leading-tight"}),e.jsx("button",{onClick:y,disabled:c,className:"p-3 bg-gradient-to-r from-cyan-500 to-emerald-500 rounded-lg text-white hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed transform hover:scale-105",children:e.jsx(M,{size:20})})]})})]})]})})}const K=({error:s})=>e.jsxs("div",{className:"bg-red-800/90 text-white p-3 text-center text-sm flex items-center justify-center gap-3",children:[e.jsx(_,{size:18}),e.jsx("span",{children:s.message}),s.type==="INVALID_API_KEY"&&e.jsx("a",{href:"https://console.groq.com/keys",target:"_blank",rel:"noopener noreferrer",className:"font-bold underline hover:text-red-200",children:"Get Key"})]}),L=({msg:s})=>e.jsx(b.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},transition:{duration:.3},className:`flex ${s.role==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{role:"log",className:`max-w-sm md:max-w-md lg:max-w-lg px-4 py-2 rounded-xl shadow-md ${s.role==="user"?"bg-gradient-to-br from-blue-600 to-blue-700 text-white rounded-br-none":`bg-slate-700/80 text-slate-200 rounded-bl-none ${s.isError?"border border-red-500":""}`}`,children:s.content})}),O=()=>e.jsx(b.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex justify-start",children:e.jsxs("div",{className:"bg-slate-700/80 text-slate-200 px-4 py-3 rounded-xl shadow-md flex items-center space-x-2 rounded-bl-none",children:[e.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-pulse [animation-delay:-0.3s]"}),e.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-pulse [animation-delay:-0.15s]"}),e.jsx("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-pulse"})]})});export{$ as default};
